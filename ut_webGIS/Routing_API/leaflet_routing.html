<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Leaflet Routing - Ø§Ù†ØªØ®Ø§Ø¨ Ù¾Ø±ÙˆÙØ§ÛŒÙ„</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <style>
    #map { height: 100vh; }
    #controls {
      position: absolute;
      top: 10px;
      left: 10px;
      background: white;
      padding: 8px;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      z-index: 1000;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <div id="controls">
    <label>Ù†ÙˆØ¹ Ù…Ø³ÛŒØ±:</label>
    <select id="profile">
      <option value="driving">ğŸš— Ù…Ø§Ø´ÛŒÙ†</option>
      <option value="cycling">ğŸš´ Ø¯ÙˆÚ†Ø±Ø®Ù‡</option>
      <option value="walking">ğŸš¶ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ±ÙˆÛŒ</option>
    </select>
  </div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
  <script>
    var map = L.map('map').setView([35.6892, 51.3890], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap'
    }).addTo(map);

    var startMarker = null;
    var endMarker = null;
    var control = null;

    // ØªØ§Ø¨Ø¹ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ
    function createRoute(profile) {
      if (control) map.removeControl(control);

      control = L.Routing.control({
        waypoints: [
          startMarker.getLatLng(),
          endMarker.getLatLng()
        ],
        router: L.Routing.osrmv1({
          serviceUrl: "https://router.project-osrm.org/route/v1",
          profile: profile
        }),
        lineOptions: { styles: [{ color: 'red', weight: 4 }] },
        show: false
      }).addTo(map);
    }

    // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡
    map.on("click", function(e) {
      if (!startMarker) {
        startMarker = L.marker(e.latlng).addTo(map).bindPopup("Ù†Ù‚Ø·Ù‡ Ø´Ø±ÙˆØ¹").openPopup();
      } else if (!endMarker) {
        endMarker = L.marker(e.latlng).addTo(map).bindPopup("Ù†Ù‚Ø·Ù‡ Ù…Ù‚ØµØ¯").openPopup();
        createRoute(document.getElementById("profile").value);
      } else {
        map.removeLayer(startMarker);
        map.removeLayer(endMarker);
        if (control) map.removeControl(control);
        startMarker = null;
        endMarker = null;
      }
    });

    // ÙˆÙ‚ØªÛŒ Ù†ÙˆØ¹ Ù…Ø³ÛŒØ± ØªØºÛŒÛŒØ± Ú©Ù†Ù‡ØŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¨Ø´Ù‡
    document.getElementById("profile").addEventListener("change", function() {
      if (startMarker && endMarker) {
        createRoute(this.value);
      }
    });
  </script>
</body>
</html>
