{% extends "admin/base_site.html" %}
{% load static %}
{% block content %}
    <div class="container mt-4">
        <h1 class="text-center mb-4">نقشه نمایندگی‌ها</h1>
        <div id="sellerMap" style="width: 100%; height: 600px;"></div>
    </div>
    <script src="{% static 'leaflet/leaflet.js' %}"></script>
    <link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %}" />
    <script>
        var map = L.map('sellerMap').setView([35.7, 51.4], 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19}).addTo(map);

        {% for seller in sellers %}
            var score = {{ seller.score|floatformat:1 }};
            var iconUrl = score >= 4 ? '{% static "img/gold-star.png" %}' : score >= 2 ? '{% static "img/red-star.png" %}' : '{% static "img/gray-star.png" %}';
            var marker = L.marker([{{ seller.geom.y }}, {{ seller.geom.x }}], {icon: L.icon({iconUrl: iconUrl, iconSize: [30, 30]})}).addTo(map);
            marker.bindPopup("<b>{{ seller.name }}</b><br>امتیاز: " + score);
        {% endfor %}
    </script>
{% endblock %}